import os
from c3d import *
from classifier import *
from utils.visualization_util import *
import sys
import glob

original_stdout=sys.stdout

def run_demo(num):
    #video="C:/Users/dalab/Documents/Graduation work3/dataset videos/Test/"+num+".mp4"
    video="C:/Users/dalab/Documents/Graduation work4/videos/was testing/"+num+".mp4"
    video_name = os.path.basename(video).split('.')[0]
    logits={}
    logits['004']=[0.9999944,0.9994916,0.9792087,0.99995434,1,1,0.9918888,0.99999857,1,1,1,1,0.9619188]
    logits['005']=[0.99999964,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]#32
    logits['006']=[8.997191e-08,9.703043e-08,0.00986853,2.388881e-06,2.7248717e-07,0.02498674,2.3420102e-06,6.0208623e-07,15352775e-11,8.003721e-11,4.533219e-12,0.00076085,3.2916336e-10,7.9215795e-13,5.46431e-16,15413525e-09,7.130782e-05,0.00010667,2.0394352e-06,15298847e-14,5.710823e-11,11213438e-13,13662307e-11]
    logits['007']=[2.6172626e-20,13848792e-19,4.6373664e-20,6.444299e-14,4.1870576e-17,2.8934232e-20,5.1521556e-06,1,1,1,1,1,1]
    logits['008']=[1,1,1,1,1,0.99999964,1,0.9999994,0.99992037,0.99998426] 
    logits['009']=[1,0.91956353,0.999907,0.99993,1,0.999915,0.9633796,0.090928,0.73407847,4.7794183e-05,0.9983156,0.9999968,0.999912,0.27099648,0.98199,0.9060723,0.6988084,0.99996436,0.97080743,0.27572024,0.00811004,0.9942967,0.99994886,0.9990689,0.9997167,0.88308424,0.96403795,0.99955434,0.99999464,0.9999988,0.9999976,1,1,0.9991417,0.99988246,1,1,0.99999917,0.99870837,0.99999356,0.9999647,0.99985254,1,1,0.9999994,1,0.99994195,0.9995511,0.9997968,0.9999962,0.9999622,0.99999034,0.9999701,0.6803688,0.88499266,0.9731934,0.00208003]
    logits['010']=[5.583879e-05,17587853e-14,7.1596425e-15,3.1573804e-14,6.333853e-08,6.4170744e-09,9.56583e-12,12320722e-07,2.9620116e-08,5.3374327e-09,7.489248e-10,5.1482967e-08,2.0333998e-07,3.073181e-05,0.00068697,7.098964e-06,11349877e-10,14421895e-09,17601888e-06,12685048e-07,4.9297864e-07,12452801e-11,4.2616772e-08,10203334e-09,8.594305e-08,6.936305e-08,7.7397107e-07,4.3532373e-09,2.4226244e-07,14529684e-05,6.012875e-08,13719499e-06,3.501761e-05,2.5199938e-06,5.8234727e-06,6.3937274e-05,8.2123483e-07,11468635e-09,2.263675e-12,17307734e-12,10423585e-09,10234591e-05,8.59993e-08,5.6646294e-15,109970125e-13,12782685e-07,3.5774344e-06,3.7408243e-10,4.7082355e-10,2.0245333e-08,6.3094695e-13,14704925e-11,2.660213e-09,2.6218654e-08,0.00015038,16151943e-09,8.469116e-09,6.83673e-08,2.4560852e-12,6.736127e-13,9.019085e-11,5.2869993e-11,5.518332e-13,2.6692848e-07,3.9866666e-07,2.9001743e-09,3.4141137e-09,4.8989333e-12,3.2262488e-11,0.00012471,0.00105683,0.00013307,6.7323724e-14,2.1875854e-12,8.0736026e-12,2.948355e-11,5.818659e-12,7.1780693e-09,6.9213374e-10,8.104239e-13,3.682626e-13,101758664e-10,2.2497592e-05,12574059e-05,5.1717347e-10,5.2598523e-11,9.656693e-10,2.754305e-10,4.2840327e-08,3.0299785e-10,6.914232e-12,7.764104e-11,1678552e-14,3.974265e-17,2.6215157e-15,6.604534e-15,11147651e-09,19773736e-13,3.4502325e-11,17636085e-11,2.2323447e-12,3.826533e-11,6.305677e-10,17760195e-16,17403107e-19,2.0020657e-15,3.393485e-18,4.3958827e-20,17330732e-15,2.8985065e-07,3.197705e-08,17714746e-10,14143753e-10,15792354e-07,10046435e-08,6.8011196e-12,19404198e-12,6.894797e-15,5.2630237e-11,2.576743e-10,13925802e-10,9.261636e-13,3.7112917e-12,16907962e-12,13331782e-14,2.3970334e-14,7.112818e-08,2.4570836e-08,2.0101156e-12,2.8233215e-08,13416263e-07,5.4441108e-11,0.00053313,0.9659999,10669878e-09,17709258e-08,2.959398e-11,11087287e-08,3.6899722e-10,8.90593e-07,2.672673e-09,8.1840007e-10,4.787057e-06,9.0309236e-08,7.698124e-09,0.01172389,0.9946504,12561109e-10,3.1017252e-14,9.092513e-14,14206693e-14,15816493e-10,4.317933e-10,13115946e-12,6.1531912e-15,5.828637e-11,5.120504e-08,6.088843e-14,6.985917e-17,14849522e-10,7.0121436e-11,17540919e-10,8.055902e-11,19926458e-10,2.2421371e-09,13833548e-13,5.435813e-10]
    logits['011']=[0.07649723,0.00375472,0.9357929,0.02060496,0.00010331,2.90177e-07,0.8942017,0.08432958,0.0129777,1314944e-19,1238364e-22,4.1118037e-06,0.00785373,11036653e-07,1,1,1,0.00097935,0.00161992,0.00689026,0.00055233,0.83929616,0.9701277,0.0225899,0.01155746,0.87818605,1,0.99999833,0.99949324,1,0.9993986,0.2940202,2.427161e-08,9.985483e-11,0.99702954,2.3122924e-08,3.710142e-10,2.8224747e-09,5.7548223e-15,7.458959e-09] 
    logits['012']=[7.5854114e-05,0.33249325,0.00037963,0.8991674,0.00181045,0.0109641,0.00058999,0.00066765,10070416e-05] 
    logits['013']=[1,1,1,1,1,0.9998822,1,1,0.9999924] 
    logits['014']=[1,1,1,1,1,1,1,1,1] 
    logits['029']=[1,0.99998736,0.878958,0.03701631,0.99823725,1,0.9999951,1,0.9999851,0.999629,0.98839045,0.9999938,0.9999764,1,1,1,1,1,1,0.99999213,0.99999833,0.99999726,0.9999994,0.9999765,0.9997323,0.99985135,0.9996086,0.9965204,0.99634486,0.9671874,0.9999944]
    logits['034']=[0.9999975,0.9999889,0.9999989,0.99996495,1,0.9999509,0.9993362,0.9999987,0.9999995]
    logits['035']=[0.00028432,0.00015322,0.7944565,0.7981425,0.7999987,0.7999765,0.79999774,0.79882416,0.00308851,0.55956594] 
    #logits['035']=[0.00028432,0.00015322,0.9944565,0.9981425,0.9999987,0.9999765,0.99999774,0.89882416,0.00308851,0.45956594] 
    logits['045']=[0.999926,0.99965847,0.29037508,0.999974,0.9999995,0.9960282,0.9965893,0.99147636,1,1,1,1,1,1,0.99999964,0.99994206,0.88443196,0.99662256,1,0.9999995] 
    logits['050']=[1,1,1,1,1,1,0.9999994,1,1,0.9999467,1,0.9999684,0.9991597,0.99999785,0.99999845,1,1,1,0.99980575,1,0.99999297] 
    logits['107']=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1] 
    logits['201']=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1] 
    logits['210']=[1,1,1,1,1,1,1,1,1] 
    logits['211']=[0.98257,0.7598681,0.00043125,0.19571418,0.00498429,2.4891346e-05,5.1519193e-05,181812e-06,4.5474662e-06,0.1066003,6.422281e-08] 
    logits['212']=[11383464e-13,0.74735546,0.0011565,0.9999181,0.998985,0.31959555,0.00040708,0.91739607,1] 
    logits['213']=[0.02436387,0.00958891,0.0186552,0.00687271,0.9983006,0.5532614,0.0001461,0.9999889,0.99967456]
    logits['214']=[8.180213e-06,5.0505995e-11,0.05379204,7.1157206e-07,18938736e-07,19122048e-10,0.00942051,17639862e-10,0.00419573] 
    logits['215']=[1,1,1,1,1,1,1,1,1]
    logits['216']=[1,1,1,1,1,1,1,1,1]
    logits['217']=[1,1,1,1,1,1,1,1,1]
    logits['218']=[0.9999995,1,1,1,1,1,1,1,1]
    logits['219']=[0.9999651,1,1,1,1,1,1,1,1,1,1,1,1]
    logits['220']=[1,1,1,1,1,1,1,1,1]
    logits['221']=[1,1,1,1,1,1,1,1,1]
    logits['222']=[1,1,1,1,1,1,1,1,1]


    # read video
    video_clips, num_frames = get_video_clips(video)

    print(num)
    print("Number of clips in the video : ", len(video_clips))

    # classify using the trained classifier model
    predictions = np.array(logits[num])
    #classifier_model.predict(rgb_feature_bag)

    #predictions = np.array(predictions).squeeze()

    predictions = extrapolate(predictions, num_frames)

    save_path = "C:/Users/dalab/Documents/Graduation work4/videos/was testing/view/"+num+"-sultani.mp4"
    # visualize predictions
    print('Executed Successfully - '+video_name + '.gif saved')
    visualize_predictions(video, predictions, save_path,num)


if __name__ == '__main__':
    
    #videos=['026','027','028','029','030','031','032','033','034','035','036','037','038','041','044','045','047','050','001','002','003','004','005','006','007','008','009','010','011','012','013','014','015','016','017','018','019','020','021','022','023','024','025']
    #videos=['004','005','006','007','008','009','010','011','012','013','014','029','034','035','045','050','107','201','210','211','212','213','214','215','216','217','218','219','220','221','222']
    videos=['035']
    for video in videos:
        run_demo(video)